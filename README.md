# Защита от атаки SYN Flood

Программа реализует систему защиты от syn flood атаки.
В программе реализованы следующий функционал
  1. Загрузчик программы для исполнения на вирутальной машине eBPF из объектного файла;
  2. Обработка пакетов приходящих с портов 80 и 443;
  3. Вычисление хэша для формирования куки с последующим сохранением его в хэш таблицу и нвправлением отвта с данным куки клиенту;
  4. Обработка ответа от клиента для завершения 3х этапного рукопожатия;
  5. Реализация сбора статистики в программе с дальнейшей передачи её в пользовательское пространство и вывод пользователю.

В общем виде реализованный алгоритм выглядит следующим орбразом:

Если пакеты пришли в порта 80 или 443, то
  Если адрес клиента в болом списке и его уровень доверия > 0, то
    Если прислал SYN, то
      Сформировать стандратный ASK ответ и отослать ему
    В остальных случаях
      Попускаем пакет в ядро
  Если клиента нет в белом списке, то
    Если клиент прислал SYN, то
      Расчитываем куки, записываем их в хэш таблицу и отправляем ему
    Если прислал ACK, то
      Если клиент прислал хэш, который если в хэш таблице, то
        Добавляем адресс клиента в белый список с уровенм доверия 100
      Иначе
        Сбрасываем пакет
    В остальных случаях
      Сбрасываем пакет
 
 Пример команды для запуска программы:
    sudo ./xdp_loader --dev ens33 --skb-mode --force
  

