# Защита от атаки SYN Flood

Программа реализует систему защиты от syn flood атаки.
В программе реализованы следующий функционал
  1. Загрузчик программы для исполнения на вирутальной машине eBPF из объектного файла;
  2. Обработка пакетов приходящих с портов 80 и 443;
  3. Вычисление хэша для формирования куки с последующим сохранением его в хэш таблицу и нвправлением отвта с данным куки клиенту;
  4. Обработка ответа от клиента для завершения 3х этапного рукопожатия;
  5. Реализация сбора статистики в программе с дальнейшей передачи её в пользовательское пространство и вывод пользователю.

В общем виде реализованный алгоритм выглядит следующим орбразом:<br><br>

Если пакеты пришли в порта 80 или 443, то<br>
* Если адрес клиента в болом списке и его уровень доверия > 0, то<br>
* * Если прислал SYN, то<br>
* * * Сформировать стандратный ASK ответ и отослать ему<br>
* * В остальных случаях<br>
* * * Попускаем пакет в ядро<br>
* Если клиента нет в белом списке, то<br>
* * Если клиент прислал SYN, то<br>
* * * Расчитываем куки, записываем их в хэш таблицу и отправляем ему<br>
* * Если прислал ACK, то<br>
* * * Если клиент прислал хэш, который если в хэш таблице, то<br>
* * * * Добавляем адресс клиента в белый список с уровенм доверия 100<br>
* * * Иначе<br>
* * * * Сбрасываем пакет<br>
* * В остальных случаях<br>
* * * Сбрасываем пакет<br>
 
 Пример команды для запуска программы:<br>
 ```
 sudo ./xdp_loader --dev ens33 --skb-mode --force
 ```

